<template>
  <div
    v-if="!loading"
    class="servers-map"
  >
    <world-map
      :points="coordinates"
      @click="viewServer"
    />
  </div>
</template>

<script>
import WorldMap from '@/components/Map.vue';

export default {
  components: {
    WorldMap
  },
  data() {
    return {
      coordinates: [],
      loading: false,
    };
  },
  created() {
    this.getServerList();
  },
  methods: {
    async getServerList() {
      this.loading = true;

      try {
        const serverResponse = await this.$store.dispatch('ServerModule/loadAllServers');

        if (!serverResponse.success) {
          console.error(serverResponse.errors);
          return;
        }

        for(let i in serverResponse.data) {
          let server = serverResponse.data[i];
          if(server.location) {

            let coordinate = [
              server.location.coordinates[1],
              server.location.coordinates[0],
              server.name,
              server.id
            ];
            this.coordinates.push(coordinate);
          }
        }
      } catch (e) {
        console.error(e);
      } finally {
        this.loading = false;
      }
    },
    viewServer(data) {
      if(data.length >= 4) {
        this.$router.push('/server/' + data[3]);
      }
    }
  },
  /*  computed: {
      getTestBnuy() {
        const coordinates = [[96.29499816894531, 52.55799865722656], [95.75558471679688, 51.59455108642578], [95.15779876708984, 50.66593551635742], [94.52559661865234, 49.76034164428711], [93.86943054199219, 48.871925354003906], [93.19500732421875, 47.997283935546875], [92.5057373046875, 47.134281158447266], [91.80378723144531, 46.281558990478516], [91.0905990600586, 45.438209533691406], [90.3670654296875, 44.603721618652344], [89.63382720947266, 43.777748107910156], [88.89115905761719, 42.960235595703125], [88.13911437988281, 42.15134811401367], [87.37744140625, 41.35151672363281], [86.60578155517578, 40.561317443847656], [85.82337188720703, 39.78177261352539], [85.02899169921875, 39.0144157409668], [84.22090911865234, 38.26152420043945], [83.39645385742188, 37.526607513427734], [82.55128479003906, 36.815650939941406], [81.6778793334961, 36.13978958129883], [80.76081085205078, 35.524993896484375], [79.7804946899414, 35.01751708984375], [79.968017578125, 34.01405715942383], [80.24004364013672, 32.94366264343262], [80.4720458984375, 31.8638858795166], [80.66324615478516, 30.77614402770996], [80.8131103515625, 29.681941986083984], [80.92137908935547, 28.582843780517578], [80.98802185058594, 27.480436325073242], [81.01272583007812, 26.376298904418945], [80.9957046508789, 25.272010803222656], [80.935302734375, 24.169254302978516], [80.8294906616211, 23.069936752319336], [80.67635345458984, 21.97620964050293], [80.47393035888672, 20.89053726196289], [80.22052764892578, 19.81562042236328], [79.91475677490234, 18.754430770874023], [79.55538940429688, 17.710174560546875], [79.14134979248047, 16.686370849609375], [78.67206573486328, 15.686699867248535], [78.1471176147461, 14.715110778808594], [77.56624603271484, 13.775901794433594], [76.92927551269531, 12.873814582824707], [76.23560333251953, 12.014595031738281], [75.4834213256836, 11.206175804138184], [74.66603088378906, 10.464049339294434], [73.83003234863281, 10.836360931396484], [73.07044219970703, 11.637796401977539], [72.3693618774414, 12.490982055664062], [71.7231216430664, 13.38647174835205], [71.13053131103516, 14.31834888458252], [70.59114837646484, 15.282008171081543], [70.1048583984375, 16.27353286743164], [69.67139434814453, 17.289260864257812], [69.29054260253906, 18.325885772705078], [68.96170806884766, 19.380165100097656], [68.68409729003906, 20.44908905029297], [68.45674896240234, 21.529823303222656], [68.27837371826172, 22.619714736938477], [68.14765930175781, 23.716354370117188], [68.06287384033203, 24.817508697509766], [68.0223159790039, 25.92116928100586], [68.02438354492188, 27.02557945251465], [68.06836700439453, 28.129127502441406], [68.15428161621094, 29.23019790649414], [68.28202819824219, 30.32719612121582], [68.45114135742188, 31.418588638305664], [68.66117858886719, 32.502859115600586], [68.91146087646484, 33.57854461669922], [68.93311309814453, 34.48381423950195], [67.86669921875, 34.76991653442383], [67.04322814941406, 34.75651931762695], [66.78987121582031, 33.681549072265625], [66.49724578857422, 32.61660385131836], [66.16524505615234, 31.563261032104492], [65.79412841796875, 30.523056030273438], [65.3841323852539, 29.497562408447266], [64.93570709228516, 28.48827362060547], [64.44937515258789, 27.496694564819336], [63.92583465576172, 26.524259567260742], [63.36593246459961, 25.57229232788086], [62.770328521728516, 24.642229080200195], [62.13877868652344, 23.736217498779297], [61.47062301635742, 22.85686683654785], [60.765254974365234, 22.00707244873047], [60.02238464355469, 21.189870834350586], [59.24195861816406, 20.40847396850586], [58.4243049621582, 19.666133880615234], [57.57006072998047, 18.966211318969727], [56.68017578125, 18.31223487854004], [55.756038665771484, 17.707624435424805], [54.799339294433594, 17.1560001373291], [53.812156677246094, 16.661033630371094], [52.79678726196289, 16.226862907409668], [51.75575637817383, 15.858484268188477], [50.69169998168945, 15.563298225402832], [49.60719299316406, 15.356388092041016], [49.02231216430664, 16.007821083068848], [48.79438781738281, 17.088239669799805], [48.64466094970703, 18.182323455810547], [48.56428146362305, 19.283702850341797], [48.54893493652344, 20.387937545776367], [48.595767974853516, 21.49128532409668], [48.702552795410156, 22.5904598236084], [48.86716842651367, 23.682485580444336], [49.087623596191406, 24.76462745666504], [49.361751556396484, 25.83443260192871], [49.687278747558594, 26.889745712280273], [50.06195831298828, 27.928638458251953], [50.48322296142578, 28.949527740478516], [50.948699951171875, 29.951034545898438], [51.45576858520508, 30.93214988708496], [52.001976013183594, 31.89204978942871], [52.58480453491211, 32.83014678955078], [53.202659606933594, 33.74556350708008], [53.854793548583984, 34.636898040771484], [54.54017639160156, 35.502899169921875], [55.257843017578125, 36.34237289428711], [56.00658416748047, 37.15425109863281], [56.7851676940918, 37.93752670288086], [57.59231185913086, 38.69136428833008], [58.42670440673828, 39.414955139160156], [59.28693771362305, 40.10755920410156], [60.171783447265625, 40.76848602294922], [61.07987594604492, 41.39710235595703], [60.824241638183594, 42.41130447387695], [60.54319381713867, 43.479217529296875], [59.791683197021484, 43.199703216552734], [58.87944030761719, 42.577171325683594], [57.94580078125, 41.98719024658203], [56.99216079711914, 41.43012619018555], [56.01981735229492, 40.906349182128906], [55.03013610839844, 40.41615676879883], [54.024383544921875, 39.95983123779297], [53.003849029541016, 39.537593841552734], [51.969764709472656, 39.14970016479492], [50.92341613769531, 38.796287536621094], [49.865970611572266, 38.477516174316406], [48.79867935180664, 38.19350051879883], [47.722721099853516, 37.944313049316406], [46.639278411865234, 37.73000717163086], [45.54951477050781, 37.55056381225586], [44.454586029052734, 37.40593719482422], [43.355613708496094, 37.296119689941406], [42.25376510620117, 37.22088623046875], [41.150062561035156, 37.18016052246094], [40.045631408691406, 37.1736946105957], [38.941551208496094, 37.201358795166016], [37.83883285522461, 37.263275146484375], [36.73861312866211, 37.35979080200195], [35.64200210571289, 37.49092102050781], [34.55009841918945, 37.65683364868164], [33.46405029296875, 37.8575553894043], [32.385047912597656, 38.09318542480469], [31.314210891723633, 38.36357498168945], [30.25278091430664, 38.668800354003906], [29.201988220214844, 39.00873565673828], [28.162982940673828, 39.383235931396484], [27.137042999267578, 39.792137145996094], [26.12540054321289, 40.23527145385742], [25.12935447692871, 40.71242141723633], [24.15021324157715, 41.22332763671875], [23.189260482788086, 41.76771545410156], [22.24786376953125, 42.34524917602539], [21.327404022216797, 42.9555549621582], [20.429227828979492, 43.598236083984375], [19.554780960083008, 44.27284622192383], [18.705522537231445, 44.978904724121094], [17.88300132751465, 45.71592330932617], [17.088626861572266, 46.48321533203125], [16.323967933654785, 47.28008270263672], [15.59069538116455, 48.10594177246094], [14.890220642089844, 48.959808349609375], [14.224252700805664, 49.84082794189453], [13.594382286071777, 50.74801254272461], [13.002198219299316, 51.680213928222656], [12.44925308227539, 52.63623809814453], [11.93709659576416, 53.61471176147461], [11.305315971374512, 54.091575622558594], [10.275694847106934, 53.70159912109375], [9.178813934326172, 53.606292724609375], [8.100266456604004, 53.825042724609375], [7.1270060539245605, 54.339664459228516], [6.324633598327637, 55.09415054321289], [5.739127159118652, 56.02717590332031], [5.408395767211914, 57.077754974365234], [5.362460136413574, 58.178001403808594], [5.606394290924072, 59.251976013183594], [6.11552619934082, 60.228797912597656], [6.8537421226501465, 61.04625701904297], [7.778852939605713, 61.64341354370117], [8.832858562469482, 61.96027755737305], [9.30552864074707, 62.51852798461914], [9.062836647033691, 63.5959358215332], [8.926037311553955, 64.6915283203125], [8.828218936920166, 65.7916488647461], [8.746695518493652, 66.89311218261719], [8.679800033569336, 67.99556732177734], [8.627116680145264, 69.09878540039062], [8.588628768920898, 70.20259857177734], [8.564783096313477, 71.30681610107422], [8.55610179901123, 72.4112548828125], [8.563216209411621, 73.51570129394531], [8.587419033050537, 74.61991882324219], [8.629800796508789, 75.72356414794922], [8.691795349121094, 76.82630920410156], [8.775108814239502, 77.9276123046875], [8.881798267364502, 79.02691650390625], [9.014451026916504, 80.12338256835938], [9.176025390625, 81.2159423828125], [9.370131492614746, 82.3031997680664], [9.601142883300781, 83.38319396972656], [9.874750137329102, 84.45316314697266], [10.197656631469727, 85.50926208496094], [10.578330039978027, 86.54590606689453], [11.02728271484375, 87.55474090576172], [11.557092666625977, 88.52342987060547], [12.182154655456543, 89.4333267211914], [12.916255950927734, 90.25731658935547], [13.76746940612793, 90.95909881591797], [14.729527473449707, 91.4982681274414], [15.77653980255127, 91.8445816040039], [16.86968421936035, 91.99212646484375], [17.974056243896484, 92], [19.078548431396484, 92], [20.183040618896484, 92], [21.287517547607422, 92], [22.392009735107422, 92], [23.496501922607422, 92], [24.60097885131836, 92], [25.70547103881836, 92], [26.80996322631836, 92], [27.91445541381836, 92], [29.018917083740234, 92], [30.123409271240234, 92], [31.227901458740234, 92], [32.332393646240234, 92], [33.436885833740234, 92], [34.541378021240234, 92], [35.64583969116211, 92], [36.75033187866211, 92], [37.85482406616211, 92], [38.95931625366211, 92], [40.06380844116211, 92], [41.168270111083984, 92], [42.272762298583984, 92], [43.377254486083984, 92], [44.481746673583984, 92], [45.586238861083984, 92], [46.690731048583984, 92], [47.79519271850586, 92], [47.859397888183594, 91.07422637939453], [47.47421646118164, 90.04256439208984], [46.843017578125, 89.13925170898438], [46.038047790527344, 88.38525390625], [45.123714447021484, 87.76718139648438], [44.14217758178711, 87.26191711425781], [43.11846923828125, 86.84806060791016], [42.0675048828125, 86.5090560913086], [40.99831008911133, 86.2325210571289], [39.91669845581055, 86.00946807861328], [38.82646560668945, 85.8331298828125], [37.73025131225586, 85.69869995117188], [36.62996292114258, 85.6031723022461], [35.527103424072266, 85.5442886352539], [34.422889709472656, 85.521484375], [34.486778259277344, 85.28926849365234], [35.4876823425293, 84.82264709472656], [36.46225357055664, 84.30316162109375], [37.40772247314453, 83.7325210571289], [38.321468353271484, 83.1122817993164], [39.200870513916016, 82.44426727294922], [40.04349136352539, 81.73043060302734], [40.84695053100586, 80.97277069091797], [41.608863830566406, 80.17332458496094], [42.327056884765625, 79.33438873291016], [42.9994010925293, 78.45830535888672], [43.62383270263672, 77.54740905761719], [44.1983528137207, 76.60431671142578], [44.72129821777344, 75.6316146850586], [45.19087600708008, 74.632080078125], [45.60563659667969, 73.60855865478516], [45.964298248291016, 72.56407928466797], [46.26575469970703, 71.50166320800781], [46.5091667175293, 70.42448425292969], [46.69405746459961, 69.33573913574219], [46.820159912109375, 68.23859405517578], [46.88751220703125, 67.13629150390625], [46.89654541015625, 66.0319595336914], [46.84733200073242, 64.92871475219727], [46.73954391479492, 63.82963943481445], [46.573036193847656, 62.73789596557617], [46.34798049926758, 61.65671920776367], [46.06484603881836, 60.58926010131836], [45.72440719604492, 59.53870391845703], [45.3276481628418, 58.508121490478516], [44.87571334838867, 57.500457763671875], [44.37015914916992, 56.51863098144531], [43.812564849853516, 55.565364837646484], [43.20450210571289, 54.643470764160156], [42.54800796508789, 53.75543212890625], [41.845069885253906, 52.90372085571289], [41.097572326660156, 52.0908088684082], [40.30784606933594, 51.31883239746094], [39.47808837890625, 50.59005355834961], [38.61066818237305, 49.90654754638672], [37.70798873901367, 49.27041244506836], [36.772525787353516, 48.68344497680664], [35.806968688964844, 48.14745330810547], [34.81404113769531, 47.66402053833008], [33.79655075073242, 47.23466491699219], [32.75741195678711, 46.86082077026367], [31.699668884277344, 46.54351806640625], [30.626314163208008, 46.28361511230469], [29.540559768676758, 46.0817985534668], [28.445554733276367, 45.93841552734375], [28.377517700195312, 45.853275299072266], [29.481582641601562, 45.82805252075195], [30.585519790649414, 45.85878372192383], [31.686281204223633, 45.947975158691406], [32.780683517456055, 46.09584426879883], [33.86558151245117, 46.30231475830078], [34.937774658203125, 46.566951751708984], [35.99407958984375, 46.88905334472656], [37.031471252441406, 47.26774215698242], [38.046932220458984, 47.70180130004883], [39.03757095336914, 48.189964294433594], [40.00053405761719, 48.7305908203125], [40.93315505981445, 49.32204055786133], [41.83280563354492, 49.96248245239258], [42.6970329284668, 50.650054931640625], [43.52338790893555, 51.3826789855957], [44.3095817565918, 52.15824508666992], [45.05339431762695, 52.974552154541016], [45.7526741027832, 53.82927322387695], [46.4053955078125, 54.72008514404297], [47.00961685180664, 55.644493103027344], [47.56346893310547, 56.59992599487305], [48.065269470214844, 57.58369445800781], [48.51344680786133, 58.593017578125], [48.90654373168945, 59.6250114440918], [49.243446350097656, 60.67672348022461], [49.523067474365234, 61.74509811401367], [49.744720458984375, 62.826988220214844], [49.90791320800781, 63.91923141479492], [50.01247024536133, 65.01862335205078], [50.058528900146484, 66.12198638916016], [50.047847747802734, 67.226318359375], [49.983646392822266, 68.32882690429688], [49.86409378051758, 69.42671966552734], [49.68743133544922, 70.51683807373047], [49.45215606689453, 71.59581756591797], [49.15717697143555, 72.66001892089844], [48.801822662353516, 73.70561981201172], [48.38594055175781, 74.7286605834961], [47.909976959228516, 75.72514343261719], [47.37489318847656, 76.69116973876953], [46.782249450683594, 77.62294006347656], [46.1341552734375, 78.51710510253906], [45.43311309814453, 79.3703842163086], [44.68223571777344, 80.1801528930664], [43.88471984863281, 80.94402313232422], [43.04416275024414, 81.6602783203125], [42.164268493652344, 82.32755279541016], [41.24864959716797, 82.94500732421875], [40.3010139465332, 83.51214599609375], [39.32500076293945, 84.02885437011719], [38.32403564453125, 84.49544525146484], [38.04896545410156, 84.77063751220703], [39.15306091308594, 84.79661560058594], [40.25526428222656, 84.86647033691406], [41.35372543334961, 84.98103332519531], [42.4462776184082, 85.14232635498047], [43.53014373779297, 85.35419464111328], [44.60165786743164, 85.62142944335938], [45.65550994873047, 85.95133972167969], [46.68409729003906, 86.35302734375], [47.67584991455078, 86.83830261230469], [48.61309814453125, 87.42155456542969], [49.46906280517578, 88.11805725097656], [50.20530700683594, 88.93950653076172], [50.7742805480957, 89.8839340209961], [51.44948959350586, 90.33618927001953], [52.48950958251953, 89.96450805664062], [53.51611328125, 89.55728149414062], [54.52803421020508, 89.11488342285156], [55.52409362792969, 88.63773345947266], [56.503074645996094, 88.12644958496094], [57.463687896728516, 87.58149719238281], [58.40471649169922, 87.00338745117188], [59.32499313354492, 86.39273834228516], [60.22311782836914, 85.75005340576172], [61.097984313964844, 85.07594299316406], [61.94819259643555, 84.37102508544922], [62.77238845825195, 83.6358871459961], [63.569313049316406, 82.87122344970703], [64.33746719360352, 82.07774353027344], [65.07504272460938, 81.77629089355469], [65.80107879638672, 82.60862731933594], [66.52710723876953, 83.44096374511719], [67.25313568115234, 84.27330017089844], [67.97917175292969, 85.10563659667969], [68.7051773071289, 85.93795013427734], [69.43121337890625, 86.7702865600586], [70.15724182128906, 87.60261535644531], [70.88327026367188, 88.43495178222656], [71.60930633544922, 89.26728820800781], [72.33533477783203, 90.09962463378906], [73.06134796142578, 90.93193817138672], [73.7873764038086, 91.76427459716797], [74.78468322753906, 92], [75.88917541503906, 92], [76.99366760253906, 92], [78.09812927246094, 92], [79.20262145996094, 92], [80.30711364746094, 92], [81.41160583496094, 92], [82.51609802246094, 92], [83.62059020996094, 92], [84.72505187988281, 92], [85.82954406738281, 92], [86.06088256835938, 91.01509857177734], [85.99720764160156, 89.91462707519531], [85.66549682617188, 88.86479949951172], [85.04986572265625, 87.9525146484375], [84.21221923828125, 87.23686218261719], [83.24090576171875, 86.71434020996094], [82.1990737915039, 86.3501205444336], [81.12158203125, 86.10946655273438], [80.02667236328125, 85.9668197631836], [78.92411041259766, 85.9054183959961], [77.81991577148438, 85.91848754882812], [77.29751586914062, 85.24520111083984], [77.09629821777344, 84.15919494628906], [76.89508056640625, 83.07318115234375], [76.69386291503906, 81.98717498779297], [76.49264526367188, 80.90119934082031], [76.79473114013672, 80.02691650390625], [77.68284606933594, 79.37059020996094], [78.52627563476562, 78.65784454345703], [79.31929779052734, 77.88934326171875], [80.05622100830078, 77.06700897216797], [80.73202514648438, 76.19371032714844], [81.3427734375, 75.27375030517578], [81.885498046875, 74.31208801269531], [82.35836029052734, 73.31419372558594], [82.76103210449219, 72.28594970703125], [83.09406280517578, 71.23310089111328], [83.35887145996094, 70.16101837158203], [83.55747985839844, 69.07469177246094], [83.692138671875, 67.97860717773438], [83.76508331298828, 66.87666320800781], [83.77794647216797, 65.77237701416016], [83.73194885253906, 64.66901016235352], [83.62586212158203, 63.569793701171875], [83.45193481445312, 62.47932434082031], [84.26842498779297, 62.22360610961914], [85.36856079101562, 62.12785720825195], [86.4601821899414, 61.96128845214844], [87.53933715820312, 61.72685623168945], [88.60210418701172, 61.426780700683594], [89.64458465576172, 61.062435150146484], [90.66251373291016, 60.63426971435547], [91.65092468261719, 60.141780853271484], [92.60340118408203, 59.5831184387207], [93.51142883300781, 58.95486068725586], [94.36279296875, 58.251834869384766], [95.138916015625, 57.4669075012207], [95.81050872802734, 56.59124755859375], [96.32984924316406, 55.618289947509766], [96.62226104736328, 54.556365966796875], [96.59886169433594, 53.45685958862305], [84.3446273803711, 51.30813217163086], [83.32495880126953, 50.92379379272461], [82.66869354248047, 50.053504943847656], [82.57957458496094, 48.967140197753906], [83.08457946777344, 48.0013542175293], [84.02743530273438, 47.454803466796875], [85.11653900146484, 47.49794006347656], [86.0135726928711, 48.11699676513672], [86.44084930419922, 49.119476318359375], [86.26665496826172, 50.19538497924805], [85.54386901855469, 51.011226654052734]];
        let geoRabbit = [];
        for (let i in coordinates) {
          geoRabbit.push([-40 + coordinates[i][0], 70 - coordinates[i][1], 'Bnuy title' + i]);
        }

        return geoRabbit;
      }
    }*/
};
</script>

<style lang="scss">
.servers-map {
  height:85vh;
  width:100%;
}
</style>
